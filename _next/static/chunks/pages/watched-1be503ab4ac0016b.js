(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[582],{727:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>n,ZB:()=>c,Zp:()=>i,aR:()=>l});var r=a(7876);a(4232);var s=a(4317);function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...a})}function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...a})}},1084:(e,t,a)=>{"use strict";a.d(t,{U:()=>s});let r=a(1040).A.create({baseURL:"https://api.themoviedb.org/3",params:{api_key:"cc9c0913f13d745d2e02ba5895f91de1"}}),s={fetchMovies:async e=>{let{adult:t,video:a,language:s,sort_by:i,page:l,with_original_language:c,with_genres:d}=e,n={include_adult:null!=t&&t,include_video:null!=a&&a,language:null!=s?s:"en",with_original_language:null!=c?c:"en",page:null!=l?l:1,sort_by:null!=i?i:"popularity.desc"};return d&&1!==d&&(n.with_genres=d),(await r.get("/discover/movie",{params:n})).data},genreService:async()=>(await r.get("/genre/movie/list")).data,fetchMovieById:async e=>(await r.get("/movie/".concat(e),{params:{append_to_response:"videos,credits"}})).data,serchMovie:async e=>{let{query:t,adult:a,language:s,page:i,with_original_language:l,with_genres:c}=e,d={query:t,include_adult:null!=a&&a,language:null!=s?s:"en",with_original_language:null!=l?l:"en",page:null!=i?i:1};return c&&1!==c&&(d.with_genres=c),(await r.get("/search/movie",{params:d})).data},fetchMovieWatchProviders:async e=>(await r.get("/movie/".concat(e,"/watch/providers"))).data.results}},2056:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/watched",function(){return a(4072)}])},2130:(e,t,a)=>{"use strict";a.d(t,{Tc:()=>l,VL:()=>i,yb:()=>s});var r=a(7274);let s=async e=>{let{data:t,error:a}=await r.N.from("watched_movies").select("movie_id").eq("user_id",e);return a?(console.error("Error fetching watched movies:",a.message),[]):t.map(e=>e.movie_id)},i=async(e,t)=>{try{let a=t.map(t=>({user_id:e,movie_id:t})),{error:s}=await r.N.from("watched_movies").upsert(a,{onConflict:"user_id, movie_id"});if(s)return console.error("Error adding watched movies:",s.message),!1;return!0}catch(e){return console.error("Unexpected error adding watched movies:",e),!1}},l=async(e,t)=>{let{error:a}=await r.N.from("watched_movies").delete().match({user_id:e,movie_id:t});return!a||(console.error("Error removing watched movie:",a.message),!1)}},4072:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(7876),s=a(4232),i=a(4403),l=a(2130),c=a(2315),d=a(727);let n=(0,a(1713).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var o=a(9688),h=a(1084),m=a(9099);let u=()=>{let{user:e}=(0,i.A)(),t=(0,m.useRouter)(),[a,u]=(0,s.useState)([]),[g,v]=(0,s.useState)([]);if((0,s.useEffect)(()=>{e&&(0,l.yb)(e.id).then(v)},[e]),!e)return t.push("/login");let x=async e=>{try{let t=e.map(e=>h.U.fetchMovieById(e)),a=await Promise.all(t);u(a)}catch(e){console.error("Failed to fetch watched movies:",e)}};(0,s.useEffect)(()=>{e&&g.length>0&&x(g)},[e,g]);let f=t=>{if(!e)return;(0,l.Tc)(e.id,t),u(e=>e.filter(e=>e.id!==t));let r=a.find(e=>e.id===t);(0,o.oR)('"'.concat(null==r?void 0:r.title,'" has been removed from your watched list.'))};return e&&0!==g.length&&0!==a.length?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-900 to-red-900",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-white mb-6",children:"My Watched Movies"}),(0,r.jsxs)("p",{className:"text-gray-400 mb-6",children:["You've watched ",a.length," movie",a.length>1?"s":""]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(e=>{var t,a;return(0,r.jsx)(d.Zp,{className:"bg-gray-800 border-gray-700",children:(0,r.jsx)(d.Wu,{className:"p-0",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"w-24 h-36 flex-shrink-0",children:(0,r.jsx)("img",{src:"https://image.tmdb.org/t/p/w500".concat(e.poster_path),alt:e.title,className:"w-full h-full object-cover rounded-l-lg"})}),(0,r.jsxs)("div",{className:"flex-1 p-4 flex flex-col justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-white mb-1",children:e.title}),(0,r.jsxs)("p",{className:"text-sm text-gray-400 mb-1",children:[null==(t=e.release_date)?void 0:t.split("-")[0]," • ",null==(a=e.genre_ids)?void 0:a.join(", ")]}),(0,r.jsxs)("p",{className:"text-sm text-gray-400",children:["⭐ ",e.vote_average]})]}),(0,r.jsxs)(c.$,{onClick:()=>f(e.id),variant:"outline",size:"sm",className:"mt-3 text-red-400 border-red-400 hover:bg-red-400 hover:text-white",children:[(0,r.jsx)(n,{className:"w-4 h-4 mr-2"}),"Remove"]})]})]})})},e.id)})})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-900 to-red-900",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8 text-center text-white",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"My Watched Movies"}),(0,r.jsx)("p",{className:"text-lg text-gray-400 mb-6",children:"No movies watched yet. Start watching!"}),(0,r.jsx)(c.$,{onClick:()=>window.location.href="/selectMovies",className:"bg-red-600 hover:bg-red-700",children:"Select Movies to Watch"})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[40,636,593,792],()=>t(2056)),_N_E=e.O()}]);